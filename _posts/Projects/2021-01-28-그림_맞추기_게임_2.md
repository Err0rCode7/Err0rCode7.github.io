---
bg: "Projects.jpg"
layout: post
title:  "그림 맞추기 게임 개발기 - 2"
crawlertitle: "그림 맞추기 게임 개발기 - 2"
summary: "그림 맞추기 게임(오늘 뭐 없나..?) - 2"
date: 2021-01-29 22:30:00 +0900
category: Projects
author: Err0rCode7
---

그림 맞추기 게임 개발기 두 번째 이야기
<br>
시퀀스 다이어그램 만들기

## 시퀀스는 어떻게 정할까 ?

멘토님의 조언을 받기 이전까지 만들었던 시퀀스는 큰 내용들은 정리가 되었지만 추상적인 느낌이 컸습니다. 시퀀스 다이어그램으로 작성하지 않고 글로 순차 나열을 했었는데, 여러 갈래로 뻗어나가는 시퀀스를 표현하는 것과 비동기적인 것을 표현하는 것이 어려웠습니다. 또한 회의를 진행할 때 가시적으로 보이지 않아 서로 얘기하는 것이 헷갈리게 되는 상황도 있었습니다.

```md
## 게임 로직
---
채팅에 포함되어야 하는 내용이지만 분리해서 정리를 진행
- `Q1`. 정답을 입력하고 확인하는 내용은 모두 소켓으로 양방향 통신이 이루어진다. 그렇다면 턴 종료, 다음 라운드 시작, 모든 라운드 종료에 대한 통신을 어떤 것으로 해야 할지에 대한 문제가 생긴다.

방에 입장하고나서 방장이 `게임 시작` 버튼을 통해 게임을 시작한다.
(유저들에게 준비 버튼이 없다고 가정)

1. 클라이언트(방장)의 `게임 시작` 버튼 클릭을 통해 서버에게 게임 시작을 요청한다.

2. 서버는 모든 클라이언트에게 `게임 시작`을 알린다.

3. 방장 이외의 모든 유저의 그림 공유(소켓) 요청을 막는다.

4. 또한 서버에서 클라이언트(방장)에게 단어를 제공한다.

	- 여러 단어 선택시 다음을 추가하여 진행한다.

		1. 클라이언트(방장)에게 n개의 단어를 제공한다.

		2. 클라이언트(방장)의 웹 화면에서 단어의 버튼을 나타낸다.

		3. 클라이언트(방장)이 버튼을 클릭하여 서버에 단어 선택을 요청한다.

5. 서버는 모든 클라이언트들에게 카운트다운 시작을 알린다.

6. 정해진 시간이 종료가 되면 서버에 턴 종료를 요청한다.

7. 6번의 요청이 왔거나, 서버에서 방장이외의 모든 클라이언트가 채팅으로 정답을 맞췄다면 턴 종료를 모든 클라이언트에게 알린다.

	- `Q1`. 이 내용은 백 엔드에서 처리하는 방법이다. 프론트 엔드에서 처리하는 것이 더 좋은 것인지 모른다.

	- 예외. 라운드 종료 처리

		1. 하나의 라운드가 종료되었으면 새로운 라운드의 시작의 내용으로 정보를 채운다.
			ex)
			```json
			{
				턴 관련 데이터 ...,
				"curRound": 2,
				"isLastRound": false,
				"isNewRound": True,
			}
			```
		- 예외. 모든 라운드 종료

			1. 클라이언트에게 모든 라운드 종료 내용의 데이터를 보내서 알린다.
			```json
			{
				턴 관련 데이터 ...,
				"curRound": 2,
				"isLastRound": True,
				"newRound": True
			}
			```

			2. 클라이언트는 내용을 받으면 웹 화면은 처음 게임 대기 화면이 된다.

		2. 다음 라운드의 시작으로 정보를 보낸다.

8. 턴에 대한 모든 내용을 초기화한다.

- **발생하는 문제**
	- `Q1`
		- 논의하여 결정해야할 문제이다.
		- 정답이 맞고 틀리고에 대한 내용은 소켓을 통해서 통신이 가능하다.
		- 게임 시작, 다음 턴과 다음 라운드, 게임 종료는 어떤 방식으로 해야할까 ?
	- `Q2`
		- 백 엔드에서 처리를 하게된다면 프론트 엔드에서는 받은 내용을 그대로 웹 화면에 보여주면된다.
		- 프론트 엔드에서 처리할 경우 자바스크립트 코드로 노출이 될 수 있다. 그렇다면 이것을 해결할 수 있을까? -> 이 부분이 어쩔 수 없는 부분인지 모르겠다.
```
<p style="font-weight:bold" align="center">처음 작성한 시퀀스 내용 일부</p>

<p align="center">
<img src="https://user-images.githubusercontent.com/48249549/106136408-9d85e880-61ac-11eb-90c9-5e2fd076abab.png">
<p style="font-weight:bold" align="center">시퀀스 흐름</p>
</p>

당연히 내용이 더 보완되어야 한다고 생각했고 어떤 방법이 좋을 까? 고민했습니다. 그러다가 이호준 멘토님이 조언해준 내용이 잘 담겨있는 [이인평 인턴님이 작성한 블로그 글](https://42place.innovationacademy.kr/archives/790)을 보게되었고 참고하여 마이크로단위로 시퀀스 다이어그램을 그려보기로 했습니다.

## 2. 시퀀스 다이어그램을 그려보자 !

저희 팀은 서비스의 내용이 1차적으로 정리가 되어있었기 때문에 곧바로 시퀀스 다이어그램을 작성하기 시작했습니다. 다이어그램의 형태로 내용을 작성하는 것은 번거로웠지만 굉장히 가시성이 좋았습니다. 모두가 순서를 보다 정확히 한 눈에 알아볼 수 있었고 어떤 내용이 빠졌는 지 알아보기 좋아 자세히 적게 되었습니다.

<p align="center">
<img src="https://user-images.githubusercontent.com/48249549/106136564-d3c36800-61ac-11eb-99d6-a7bf73310b28.png">
<img src="https://user-images.githubusercontent.com/48249549/106276552-18b5d000-627b-11eb-8451-d230a4a7202f.png">
<p style="font-weight:bold" align="center">시퀀스 다이어그램 일부</p>
</p>

시퀀스 다이어그램을 작성하는 것은 쉽지 않았습니다. 가시성이 좋아 어느 내용이 빠졌는 지 알기 좋았지만 작성하는 것이 익숙치 않고 경험이 적어 중간중간 표현하는 방식에서 어려움이 느껴졌습니다. 예를 들어 조건문, 타임아웃과 같은 비동기 작업 등에서 어떻게 작성하는 것이 명료한 지 알 수 없었고 블로그 내용과 구글링를 통해 서로가 명료하다고 생각되는 방법으로 선택하여 진행을 해야했습니다. 그리고 모두가 참여할 수 있는 시간을 잡고 회의를 진행하여 시퀀스 결정해야했기 때문에 시퀀스의 작업 시간은 계속해서 길어졌습니다.
