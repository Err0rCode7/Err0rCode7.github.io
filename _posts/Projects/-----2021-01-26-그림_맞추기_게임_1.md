---
bg: "Projects.jpg"
layout: post
title:  "그림 맞추기 게임 개발기 - 1"
crawlertitle: "그림 맞추기 게임(오늘 뭐 없나..?) - 1"
summary: "그림 맞추기 게임(오늘 뭐 없나..?) - 1"
date: 2021-01-26 16:30:00 +0900
category: Projects
author: Err0rCode7
---

#### 그림 맞추기 게임 개발기 첫 번째 이야기
##### 프로젝트 동기와 시작

## 프로젝트 기회
---

최근 42서울 슬랙에 오종인 멘토님께서 자유롭게 프로젝트나 스터디를 하고자하는 사람들을 모으는 글을 올리셨는데, 웹 프로젝트를 참여할 수 있는 기회다싶어 바로 참여 신청!! 을 했습니다. 이후에 신청한 사람들이 모두 모여서 ZOOM으로 온라인 미팅을 하게 되었는데 42서울에서 추구하는 동료 학습에 대한 이런 저런 이야기를 해보았습니다.

프로젝트라는 것은 `좋은 기획으로 좋은 아이템을 개발하는 것`이라는 단순한 생각만을 갖고있었는데, 이 미팅에서 생각이 바뀌었습니다. 우리가 해야할 프로젝트는 `어떻게하면 동료 학습을 잘 할 수 있을까?` 를 배우는 것이고 어떻게 협업을 해야하는 지를 배우는 과정이 되어야 했습니다. 뒤통수를 여러대 맞은 듯한 느낌이 들었고 42서울 피씬 과정이 생각나면서 그때의 설렘이 다시 느꼈습니다. 

미팅이 끝난 후 미팅에 같이 참여한 이전부터 공부하던 동료들과 모여 프로젝트에 대해서 이런저런 얘기를 나누어보았고 미팅에서의 느낀 설렘을 갖고 5명이서 웹 프로젝트를 진행하게 되었습니다.

## 프로젝트 시작
---

이렇게 모인 팀은 소규모 프로젝트의 경험이 1번 이상이 있는 2명과 프로젝트의 경험이 없는 3명으로 이루어진 상황이였습니다. 우리 팀은 어떻게 시작해야할까.. 언어 공부를 먼저해야할까.. 생각을 하다가 일단 어떤 것을 만들지 먼저! 라는 생각으로 기획 회의 일정을 잡고 회의에 돌입했습니다.

기획은 순조로웠습니다. 여러 의견들이 있었지만 그 중 모두의 관심을 이끈 주제가 하나 있었는데 바로 그림 그리기 게임이었습니다! 그림 그리기 게임 같은 경우 기획자체가 독창성이나 시장성 같은 내용 거의 없는 것과 다름이 없었습니다. 그 이유는 평소에 우리 스터디원들이 같이 즐겨하던 이미 있는 게임이었기 때문입니다. 하지만 모두의 관심을 끈 이유는 프로젝트의 목표에 있었습니다. 저희 팀원이 프로젝트를 하게된 이유는 동료학습을 하기 위함이었고 이미 있는 게임을 우리만의 방식으로 재구성하여 프로덕트를 만들어 보는 것은 동료학습을 어떻게 할 수 있는지 배우기에는 아주 좋은 기획이었습니다. 이렇게 그림 그리기 게임 프로젝트가 시작이 되었습니다.


## 일단 도전 !

이제 `어떤 내용을 개발할 것인가? 어떻게 개발할 것인가?` 의 과정이 시작 되었습니다.

기획의 내용은 프로토타입으로 삼는 게임이 있었기 때문에 모두가 대략적으로 인지하고 있었습니다. 그래서 우리 팀은 어떻게 만들었지? 라는 궁금증을 먼저 풀기위해 각자 1주 간의 공부 기간을 갖기로 했습니다. 하지만 1주 뒤, 저희 팀은 잘못된 선택이었다는 것을 깨닫게 됩니다.

1주 간의 기간동안 프로젝트의 경험이 있던 두 명은 핵심 기능을 어떤식으로 개발했구나 라는 감각을 익힐 수 있었지만 프로젝트의 경험이 없던 세 명은 너무 내용이 방대하기 때문에 전혀 감을 못잡았고 효율적으로 시간을 보내지 못했습니다. 이 과정 중에 팀원 한 명이 42서울 이호준 멘토님에게 개인 멘토링을 받다가 프로젝트의 내용을 얘기하게 되었는데, 여러 조언과 이런식으로 진행하면 `1년을 만들어도 만들어낼 수 없다` 라는 경각심을 주는 조언을 듣고 매우 잘못하고 있다라는 것을 인지하게 되었습니다.

그래서 저희 팀은 조언해주신 내용대로 제일 핵심이 되는 기능만을 선택해서 먼저 만들어보고 점진적으로 나아가기로 결정했습니다. 작은 단위부터 만들어 보기 시작했고 그러기위해서 만들고자 하는 게임에는 어떤 기능들이 있는가 전체적인 기능을 살펴보아야 했습니다. 게임이 시작되는 처음 부분부터 끝까지 파워포인트를 이용하여 한 부분씩 순서를 생각하며 기능 흐름과 와이어 프레임을 작성을 했고 하나씩 나아가면서 `이 많은 기능을 무턱대고 공부하자고 했구나` 라는 생각이 들었습니다.

<p align="center">
  <img src="https://user-images.githubusercontent.com/48249549/108503345-8fcd0a00-72f7-11eb-8d50-acede327f70a.png" />
  <p style="font-weight:bold" align="center">기능 흐름과 와이어 프레임 일부</p>
</p>

와이어 프레임이 끝나고 `가장 핵심이 되는 기능이 뭘까?` 회의를 나누었고 답은 실시간 그림 공유였습니다. 핵심 기능을 선택하고나서는 어떻게 동작하는 지에대한 순서를 만드는 과정을 시작했습니다. 이 과정에서 새로운 문제가 생기기 시작했습니다.

첫 째로 어느정도까지 자세하게 동작을 나타내야 하는 지를 몰랐습니다. 유저의 동작 하나하나까지 적는 것이 좋은 지, 서버에서 처리하는 부분이나 UI를 보여주는 부분 같은 점의 적정선을 정하는 것들이 어렵게 다가왔습니다.

두 번째로 어떤 동작을 해야하는 지를 생각해내기가 어려웠습니다. 저번 1주 공부기간 동안 어떻게 개발할 수 있을 지 맛을 볼 수 있었던 두 명은 어느 정도 내용의 얘기를 꺼낼 수 있었지만 어려운 내용이 나올때에 얘기를 나누기 어려웠고 갖고 있는 지식이 달라 모두가 다 같이 의견을 말해나가면서 정하는 것이 불가능했습니다.

그래서 이번에도 다시한번 이호준 멘토님을 찾아가 조언을 구해보았고 이호준 멘토님께서 시퀀스를 작성하는 것의 목적은 모두가 똑같은 내용을 인지하고 개발할 수 있도록 하는 것이기 때문에 최대한 자세하게 마이크로 단위로 기록하는 것이 좋다. 라는 내용을 얘기해주시며 어떻게 개발해야되는 지가 아니라 어떤 순서로 클라이언트와 서버의 행위를 해야하는 지로 접근하여 시퀀스를 작성하라고 조언을 해주셨습니다. 그리고 멘토님께서 담당했던 인턴분이 진행했던 프로젝트 과정에 대한 내용의 포스팅을 같이 얘기해주시면서 프로젝트의 가장 중요한 것은 협업이고 그렇기 때문에 문서화가 중요하다 라고 해주셨습니다.

저희 팀은 다시한번 시퀀스를 만드는 이유에 대해 느끼며 생각을 더 많이 해볼 필요 없이 우리 팀은 이호준 멘토님께서 말씀하신 내용을 토대로 일단 도전 부딪혀보기로 했습니다. 최대한 자세하게 시퀀스를 만들되 집단 지성으로 어떤식으로 시퀀스를 만들 수 있을지 얘기하며 나아가기로 결정을 하고 시퀀스를 하나하나 만들기 시작했습니다.

#### 그림 맞추기 게임 개발기 두 번째 이야기
##### 시퀀스 다이어그램 만들기

## 시퀀스는 어떻게 정할까 ?

멘토님의 조언을 받기 이전까지 만들었던 시퀀스는 큰 내용들은 정리가 되었지만 추상적인 느낌이 컸습니다. 시퀀스 다이어그램으로 작성하지 않고 글로 순차 나열을 했었는데, 여러 갈래로 뻗어나가는 시퀀스를 표현하는 것과 비동기적인 것을 표현하는 것이 어려웠습니다. 또한 회의를 진행할 때 가시적으로 보이지 않아 서로 얘기하는 것이 헷갈리게 되는 상황도 있었습니다.

```md
## 게임 로직
---
채팅에 포함되어야 하는 내용이지만 분리해서 정리를 진행
- `Q1`. 정답을 입력하고 확인하는 내용은 모두 소켓으로 양방향 통신이 이루어진다. 그렇다면 턴 종료, 다음 라운드 시작, 모든 라운드 종료에 대한 통신을 어떤 것으로 해야 할지에 대한 문제가 생긴다.

방에 입장하고나서 방장이 `게임 시작` 버튼을 통해 게임을 시작한다.
(유저들에게 준비 버튼이 없다고 가정)

1. 클라이언트(방장)의 `게임 시작` 버튼 클릭을 통해 서버에게 게임 시작을 요청한다.

2. 서버는 모든 클라이언트에게 `게임 시작`을 알린다.

3. 방장 이외의 모든 유저의 그림 공유(소켓) 요청을 막는다.

4. 또한 서버에서 클라이언트(방장)에게 단어를 제공한다.

	- 여러 단어 선택시 다음을 추가하여 진행한다.

		1. 클라이언트(방장)에게 n개의 단어를 제공한다.

		2. 클라이언트(방장)의 웹 화면에서 단어의 버튼을 나타낸다.

		3. 클라이언트(방장)이 버튼을 클릭하여 서버에 단어 선택을 요청한다.

5. 서버는 모든 클라이언트들에게 카운트다운 시작을 알린다.

6. 정해진 시간이 종료가 되면 서버에 턴 종료를 요청한다.

7. 6번의 요청이 왔거나, 서버에서 방장이외의 모든 클라이언트가 채팅으로 정답을 맞췄다면 턴 종료를 모든 클라이언트에게 알린다.

	- `Q1`. 이 내용은 백 엔드에서 처리하는 방법이다. 프론트 엔드에서 처리하는 것이 더 좋은 것인지 모른다.

	- 예외. 라운드 종료 처리

		1. 하나의 라운드가 종료되었으면 새로운 라운드의 시작의 내용으로 정보를 채운다.
			ex)
			```json
			{
				턴 관련 데이터 ...,
				"curRound": 2,
				"isLastRound": false,
				"isNewRound": True,
			}
			```
		- 예외. 모든 라운드 종료

			1. 클라이언트에게 모든 라운드 종료 내용의 데이터를 보내서 알린다.
			```json
			{
				턴 관련 데이터 ...,
				"curRound": 2,
				"isLastRound": True,
				"newRound": True
			}
			```

			2. 클라이언트는 내용을 받으면 웹 화면은 처음 게임 대기 화면이 된다.

		2. 다음 라운드의 시작으로 정보를 보낸다.

8. 턴에 대한 모든 내용을 초기화한다.

- **발생하는 문제**
	- `Q1`
		- 논의하여 결정해야할 문제이다.
		- 정답이 맞고 틀리고에 대한 내용은 소켓을 통해서 통신이 가능하다.
		- 게임 시작, 다음 턴과 다음 라운드, 게임 종료는 어떤 방식으로 해야할까 ?
	- `Q2`
		- 백 엔드에서 처리를 하게된다면 프론트 엔드에서는 받은 내용을 그대로 웹 화면에 보여주면된다.
		- 프론트 엔드에서 처리할 경우 자바스크립트 코드로 노출이 될 수 있다. 그렇다면 이것을 해결할 수 있을까? -> 이 부분이 어쩔 수 없는 부분인지 모르겠다.
```
<p style="font-weight:bold" align="center">혼자 글로 작성해본 시퀀스 일부</p>

<p align="center">
<img src="https://user-images.githubusercontent.com/48249549/106136408-9d85e880-61ac-11eb-90c9-5e2fd076abab.png">
<p style="font-weight:bold" align="center">시퀀스 흐름</p>
</p>

당연히 내용이 더 보완되어야 한다고 생각했고 어떤 방법이 좋을 까? 고민했습니다. 그러다가 이호준 멘토님이 조언해준 내용이 잘 담겨있는 [이인평 인턴님이 작성한 블로그 글](https://42place.innovationacademy.kr/archives/790)을 보게되었고 참고하여 마이크로단위로 시퀀스 다이어그램을 그려보기로 했습니다.

## 2. 시퀀스 다이어그램을 그려보자 !

저희 팀은 서비스의 내용이 1차적으로 정리가 되어있었기 때문에 곧바로 시퀀스 다이어그램을 작성하기 시작했습니다. 다이어그램의 형태로 내용을 작성하는 것은 번거로웠지만 굉장히 가시성이 좋았습니다. 모두가 순서를 보다 정확히 한 눈에 알아볼 수 있었고 어떤 내용이 빠졌는 지 알아보기 좋아 자세히 적게 되었습니다.

<p align="center">
	<img src="https://user-images.githubusercontent.com/48249549/106136564-d3c36800-61ac-11eb-99d6-a7bf73310b28.png">
	<img src="https://user-images.githubusercontent.com/48249549/106276552-18b5d000-627b-11eb-8451-d230a4a7202f.png">
	<p style="font-weight:bold" align="center">시퀀스 다이어그램 일부</p>
</p>

시퀀스 다이어그램을 작성하는 것은 쉽지 않았습니다. 가시성이 좋아 어느 내용이 빠졌는 지 알기 좋았지만 작성하는 것이 익숙치 않고 경험이 적어 중간중간 표현하는 방식에서 어려움이 느껴졌습니다. 예를 들어 조건문, 타임아웃과 같은 비동기 작업 등에서 어떻게 작성하는 것이 명료한 지 알 수 없었고 블로그 내용과 구글링를 통해 서로가 명료하다고 생각되는 방법으로 선택하여 진행을 해야했습니다. 그리고 모두가 참여할 수 있는 시간을 잡고 회의를 진행하여 시퀀스 결정해야했기 때문에 시퀀스의 작업 시간은 계속해서 길어졌습니다.

## 시퀀스 다이어그램은 옳다.

시퀀스 다이어그램을 적다보니 하나의 시퀀스에 모두 적기에는 어려운 부분이 생기기 시작했습니다. 하나의 시퀀스로 나누었던 것의 단위가 예상보다 더 큰 뭉치였던 것이었습니다. 그래서 이것을 더 작은 단위의 시퀀스로 나누어야 했는데 이 과정에서 부족하다고 인지하지 못했던 시퀀스에서 부족함을 느껴 다시 되돌아가 내용을 알맞게 수정 하는 경우가 생기기도 했습니다.

<p align="center">
	<img src="https://user-images.githubusercontent.com/48249549/109292917-6cadd780-786e-11eb-90ff-37bf596775c5.png">
	<p style="font-weight:bold" align="center">시퀀스 다이어그램 일부</p>
</p>


그리고 시퀀스를 작성하면서 난해했던 부분이 있었는데, 바로 비동기로 동작하는 시간초과의 내용을 넣는 부분이었습니다. 시간초과를 나타낼 때 시간의 생명주기를 적어넣는 것과 중간에 완료가 되는 인터럽트를 가시적으로 그리는 것이 어려웠습니다. 고민 끝에 Loop 박스와 분기를 이용하여
모두가 생각하는 최선으로 작성을 마무리 하였습니다. 전체적으로 유저가 게임에 참여하는 흐름에 따라 시퀀스를 살펴보면서 시퀀스 다이어그램의 작성이 끝나게 되었습니다.

## 2. 서비스 데이터

시퀀스 다이어그램은 작성했지만 이 내용만으로 누군가 봤을 때 클라이언트와 서버가 어떤 내용을 주고 받는 지에 대한 내용은 전혀 알 수 없었습니다. 그래서 저희 팀은 시퀀스를 따라서 어떤 데이터를 교환해야하는 지 서비스 데이터를 작성하기로 했습니다.

시퀀스를 처음부터 흐름을 순차적으로 살펴보면서 상황에 따라 어떤 데이터가 필요한지 도출해보는 방식으로 회의를 진행하기 시작했습니다. 현재 목표는 주요 기능인 그림 그리기 게임의 동작 구현이고 DB와 통신하는 부도 없고 소켓 통신으로 데이터가 오고 가고 하는 부분을 작성하면 되기 때문에 내용이 간단했습니다.

클라이언트와 서버가 소켓 통신하는 것을 이벤트 명과 Content로 나누었고 Content안에 둘이 통신하는 데이터의 타입과 변수 명을 정의했습니다.

#### 남은 내용

개발 시작

프로젝트 개발 시작 회의
백엔드 개발 진행 회의

코딩 컨벤션
커밋 컨벤션
깃허브 활용 (이슈, 프로젝트, PR)
이슈 컨벤션
주석 컨벤션

처음 풀리퀘스트와 오프라인 회의

1차 개발 내용 합치기

앞으로의 진행

프로젝트 종료